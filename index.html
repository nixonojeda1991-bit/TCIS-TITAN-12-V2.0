<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TCIS TITAN V5.3 | Estabilidad y Resiliencia Visual</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos CSS Alqu√≠micos (Mayor Espacio y Contraste) */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 18px; 
            width: 18px;
            border-radius: 50%;
            background: #d946ef; /* Morado/P√∫rpura para Contraste */
            cursor: pointer;
            margin-top: -7px; 
            box-shadow: 0 0 8px rgba(217, 70, 239, 0.7);
        }
        body {
            background-color: #000000; 
            color: #E0E0E0; 
            padding: 4rem 1rem; /* M√°s Padding Global */
        }
        .master-container {
            background-color: #1a1a1a;
            border-color: #333333;
            padding: 3rem; /* M√°s Padding Interno */
        }
        .auditoria-panel {
            padding: 2rem; /* M√°s espacio dentro de los paneles */
            border-radius: 12px;
        }
        /* Estilos CSS B√ÅSICOS de emergencia para enlaces (Asegura visibilidad si Tailwind colapsa) */
        .basic-button {
            display: block;
            text-align: center;
            padding: 1rem;
            border-radius: 0.75rem;
            font-weight: bold;
            transition: background-color 0.3s;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="w-full max-w-2xl master-container rounded-2xl shadow-2xl border">

        <header class="text-center mb-12">
            <h1 class="text-5xl font-extrabold text-[#d946ef] mb-3 tracking-wider">TCIS TITAN V5.3</h1>
            <p class="text-2xl font-light text-white/90">El Sistema Operativo del Alquiler Mental</p>
            <p class="text-sm text-gray-500 mt-2">Integridad Total: F√âNIX, LOGOS, CRONOS. Resiliencia Visual.</p>
        </header>

        <div id="auditoria" class="space-y-10">

            <div class="bg-[#242424] auditoria-panel border border-[#3d3d3d]">
                <h3 class="text-xl font-bold text-white mb-2">1. Intenci√≥n Pura (ECO)</h3>
                <p class="text-sm text-gray-400 mb-4">Define el objetivo que la inercia est√° congelando (IVG).</p>
                <input type="text" id="intencion" placeholder="Ej: Lanzar mi Red Social de Conciencia" class="w-full p-3 bg-black/40 border border-gray-600 rounded-md text-white focus:ring-[#d946ef] focus:border-[#d946ef]">
            </div>

            <div class="bg-[#242424] auditoria-panel border border-[#3d3d3d]">
                <h3 class="text-xl font-bold text-white mb-4">2. Auditor√≠a F√âNIX (Ley Cero)</h3>
                <p class="text-sm text-gray-400 mb-6">Cuantifica las fuerzas de Arqu√≠medes (G(A) vs G(I)).</p>

                <label for="ga" class="block text-sm font-medium text-gray-300 mb-2">G(A): El Miedo/Costo de Intentarlo - (0% a 100%)</label>
                <input type="range" id="ga" min="0" max="100" value="50" class="w-full h-3 bg-gray-700 rounded-lg appearance-none cursor-pointer range-lg">
                <p id="ga-valor" class="text-right text-red-500 font-bold mb-6">50%</p>

                <label for="gi" class="block text-sm font-medium text-gray-300 mb-2">G(I): El Arrepentimiento/Obsolescencia Futura - (0% a 100%)</label>
                <input type="range" id="gi" min="0" max="100" value="50" class="w-full h-3 bg-gray-700 rounded-lg appearance-none cursor-pointer range-lg">
                <p id="gi-valor" class="text-right text-green-500 font-bold mb-6">50%</p>
            </div>
            
            <button onclick="ejecutarAuditoria()" class="w-full p-5 bg-[#d946ef] hover:bg-[#c026d3] text-white text-lg font-extrabold rounded-xl transition shadow-xl shadow-[#a855f7]/50 tracking-wide">
                EJECUTAR AUDITOR√çA TIT√ÅN
            </button>
        </div>
        
        <hr class="my-12 border-gray-700">

        <div id="resultado" class="p-0 hidden">
            <h2 class="text-2xl font-bold text-white mb-6 border-b border-gray-700 pb-3">3. AN√ÅLISIS DE LA FRICCI√ìN (LOGOS)</h2>
            <div class="p-8 bg-[#242424] border border-[#3d3d3d] rounded-xl">
                <h3 id="titulo-resultado" class="text-3xl font-extrabold text-center text-white mb-4"></h3>
                <p id="subtitulo-resultado" class="text-md text-center text-gray-400 mb-6"></p>

                <div class="space-y-5">

                    <div class="flex items-center justify-between p-4 bg-black/40 border border-[#a855f7]/50 rounded-lg">
                        <div>
                            <h3 class="text-xl font-bold text-white">TCIS TITAN PRO</h3>
                            <p class="text-xs text-gray-400">PROTOCOLO L.I.S. (LICENCIA PERSONAL)</p>
                        </div>
                        <div class="text-right">
                            <span class="text-lg font-bold text-gray-500 line-through mr-2">$97.00</span>
                            <span class="text-3xl font-extrabold text-yellow-400">$5</span>
                            <p class="text-xs text-gray-400">Pago √önico</p>
                        </div>
                    </div>

                    <a id="boton-pago" 
                       href="https://www.paypal.com/donate/?hosted_button_id=JUQ6B9EU7YHZQ&item_name=TCIS%20TITAN%20PRO%3A%20L.I.S.%20Scorecard%20(Mandato%20Causal)&amount=5.00&currency_code=USD&business=tcistitan%40gmail.com&return=https%3A%2F%2Ftcistitan-redireccion.pages.dev" 
                       target="_blank" 
                       class="hidden basic-button w-full bg-red-800 hover:bg-red-700 text-white text-lg font-extrabold shadow-xl shadow-red-900/50 tracking-wide">
                        <span>ACTIVAR PROTOCOLO L.I.S. ($5)</span>
                    </a>
                    
                    <p class="text-sm text-center text-gray-400 pt-2">Acceda al <a href="#" class="text-[#d946ef] hover:underline font-semibold">Procedimiento Operativo Estandarizado (PDF)</a>. Incluye la L.I.S. Scorecard.</p>

                    <div class="text-center mt-6 border-t border-gray-700 pt-5">
                        <p class="text-base text-white font-bold mb-2">ACEPTAMOS: Tarjeta de Cr√©dito/D√©bito (Sin cuenta PayPal)</p>
                        <img src="https://www.paypalobjects.com/images/shared/accept-mark-std.png" 
                             alt="Tarjetas aceptadas: Visa, Mastercard, American Express" 
                             class="mx-auto w-3/4 max-w-[280px] opacity-80" />
                        <p class="text-xs text-gray-500 mt-3">Transacci√≥n segura con la tecnolog√≠a de PayPal. (Busque la opci√≥n "Pagar con tarjeta")</p>
                    </div>

                    <a id="whatsapp-link" href="https://wa.me/XXXXXXXXXX" target="_blank" class="basic-button w-full text-white bg-green-600 hover:bg-green-700 font-bold transition mt-5 border border-green-800">
                        <span>CONTACTO B2B (LICENCIA COMERCIAL)</span>
                    </a>

                    <div class="mt-6 p-4 bg-red-900/20 border-l-4 border-yellow-500 rounded-md">
                        <strong class="text-yellow-400 text-sm">ADVERTENCIA CORPORATIVA / USO COMERCIAL:</strong>
                        <p class="text-xs text-gray-300 mt-1">La Licencia TITAN PRO ($5) es estrictamente PERSONAL. El uso para decisiones de Alto Capital (> $10k) o Corporaciones requiere una Licencia Comercial TITAN.</p>
                    </div>
                    
                </div>
            </div>
        </div>

        <hr class="my-12 border-gray-700">


        <footer class="text-center text-xs text-gray-600">
            <p>¬© 2025 TCIS TITAN | V5.3 RESILIENCIA</p>
            <p id="estado-sistema" class="mt-1">Estado del Sistema: Online</p>
            <button onclick="mostrarAdmin()" class="mt-2 text-xs text-red-700 hover:text-red-500 transition">Controles Soberanos</button>

            <div id="admin-panel" class="mt-4 p-4 bg-[#242424] rounded-lg border border-[#3d3d3d] hidden">
                <h4 class="text-lg font-bold text-white mb-3">ACCESO LOGOS (ADMIN)</h4>
                <input type="email" id="admin-email" placeholder="Email Arquitecto" value="nixonojeda1991@gmail.com" class="w-full p-2 mb-2 bg-black/40 border border-gray-600 rounded-md text-white text-sm">
                <input type="password" id="admin-password" placeholder="Contrase√±a Soberana" class="w-full p-2 mb-3 bg-black/40 border border-gray-600 rounded-md text-white text-sm">
                <button onclick="loginAdmin()" class="w-full p-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded-md">Acceder</button>
                <p id="admin-mensaje" class="mt-2 text-red-400 text-sm hidden">Credenciales inv√°lidas o fallo en la conexi√≥n API.</p>
            </div>
        </footer>

    </div>

    <script type="module">
        // Importaciones de Firebase 
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-firestore.js";

        // === CONFIGURACI√ìN CR√çTICA (REEMPLAZA ESTOS VALORES MANUALMENTE) ===
        const firebaseConfig = {
            apiKey: "TU_CLAVE_API_AQUI", // üö® 1. PEGA TU CLAVE API REAL AQU√ç
            authDomain: "tcis-titan-12.firebaseapp.com",
            projectId: "tcis-titan-12",
            storageBucket: "tcis-titan-12.firebasestorage.app",
            messagingSenderId: "298942508038",
            appId: "1:298942508038:web:a7107a1cdc65216ec96787",
            measurementId: "G-F3J54D4M57"
        };
        const WHATSAPP_NUMBER = "04124577822"; // üö® 2. PEGA TU N√öMERO DE WHATSAPP AQU√ç (ej. 584241234567)
        // ====================================================================

        let app, auth, db;
        let isFirebaseConnected = false;

        try {
            // F√âNIX VERIFICACI√ìN: Solo intentar conectar si la API Key fue reemplazada
            if (firebaseConfig.apiKey && firebaseConfig.apiKey !== "AIzaSyCCcS9E9nGEb2cg0vVjBGLX01G-McfjN-M") {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
                isFirebaseConnected = true;
            } else {
                console.warn("F√âNIX ADVERTENCIA: La API Key no ha sido reemplazada. CRONOS deshabilitado. L√≥gica visual activa.");
            }
        } catch(e) {
            console.error("F√âNIX ERROR CR√çTICO: Fallo al conectar Firebase.", e);
        }
        
        // Actualizar el enlace de WhatsApp al iniciar
        document.getElementById('whatsapp-link').href = `https://wa.me/${WHATSAPP_NUMBER}`;

        // Referencias del DOM y l√≥gica de sliders
        const gaSlider = document.getElementById('ga');
        const giSlider = document.getElementById('gi');
        const gaValor = document.getElementById('ga-valor');
        const giValor = document.getElementById('gi-valor');
        const resultadoDiv = document.getElementById('resultado');
        const tituloResultado = document.getElementById('titulo-resultado');
        const subtituloResultado = document.getElementById('subtitulo-resultado');
        const adminPanel = document.getElementById('admin-panel');
        const adminMensaje = document.getElementById('admin-mensaje');
        const botonPago = document.getElementById('boton-pago');
        
        gaSlider.addEventListener('input', () => { gaValor.textContent = gaSlider.value + '%'; });
        giSlider.addEventListener('input', () => { giValor.textContent = giSlider.value + '%'; });

        // FUNCI√ìN CLAVE: LEY CERO (AGENTE F√âNIX)
        window.ejecutarAuditoria = async () => {
            const intencion = document.getElementById('intencion').value.trim();
            const ga = parseInt(gaSlider.value);
            const gi = parseInt(giSlider.value);

            if (!intencion) { alert("ECO requiere la Intenci√≥n Pura (Paso 1)."); return; }

            let titulo = ''; let subtitulo = ''; let colorClass = '';
            
            if (gi > ga) {
                titulo = "‚úÖ EJECUCI√ìN INEVITABLE";
                subtitulo = "La Ley Cero es clara: ¬°Act√∫a ahora! El riesgo de inacci√≥n es mayor.";
                colorClass = 'text-green-500';
                botonPago.classList.remove('hidden'); // CR√çTICO: Muestra el bot√≥n
            } else if (ga > gi) {
                titulo = "üõë VETO DE F√âNIX";
                subtitulo = "Reestructuraci√≥n necesaria. El costo/miedo es demasiado alto para esta Intenci√≥n.";
                colorClass = 'text-red-500';
                botonPago.classList.add('hidden'); 
            } else { 
                titulo = "‚è≥ PAR√ÅLISIS ABSOLUTA";
                subtitulo = "La Indecisi√≥n es el fallo de seguridad que congela la conciencia (G(A) = G(I)).";
                colorClass = 'text-yellow-500';
                botonPago.classList.add('hidden'); 
            }

            resultadoDiv.classList.remove('hidden');
            tituloResultado.textContent = titulo;
            subtituloResultado.textContent = subtitulo;
            tituloResultado.className = `text-3xl font-extrabold text-center ${colorClass} mb-4`;
            
            // L√≥gica de registro en Firestore (CRONOS) - Solo si la conexi√≥n fue exitosa
            if (isFirebaseConnected && db) { 
                const user = auth.currentUser;
                const userId = user ? user.uid : 'anon-' + Date.now();
                if (user || intencion.length > 0) {
                    try {
                        await setDoc(doc(db, "artifacts", "tcis-titan-12", "audits", userId + "_" + Date.now()), {
                            uid: userId, ts: serverTimestamp(), intent: intencion,
                            ga: ga, gi: gi, result: titulo
                        });
                    } catch(e) { console.error("CRONOS: Error al registrar en Firestore.", e); }
                }
            }
        };

        // Funciones de Administrador (LOGOS)
        window.mostrarAdmin = () => { 
            adminPanel.classList.toggle('hidden'); 
            adminMensaje.classList.add('hidden'); 
        };

        window.loginAdmin = async () => {
            if (!isFirebaseConnected || !db) {
                adminMensaje.textContent = "ERROR: No hay conexi√≥n a la base de datos (Revise API Key).";
                adminMensaje.classList.remove('hidden', 'text-green-500');
                adminMensaje.classList.add('text-red-400');
                return;
            }

            const email = document.getElementById('admin-email').value;
            const password = document.getElementById('admin-password').value;
            adminMensaje.classList.add('hidden');
            try {
                await signInWithEmailAndPassword(auth, email, password);
                adminMensaje.textContent = "Bienvenido, Arquitecto. Controles Soberanos Activados.";
                adminMensaje.classList.remove('hidden', 'text-red-400');
                adminMensaje.classList.add('text-green-500');
                adminPanel.classList.add('hidden');
                document.getElementById('estado-sistema').textContent = "Estado del Sistema: Control Soberano (Admin)";
            } catch (error) {
                adminMensaje.textContent = "Error: Credenciales inv√°lidas.";
                adminMensaje.classList.remove('hidden', 'text-green-500');
                adminMensaje.classList.add('text-red-400');
            }
        };

        // Exportar funciones para acceso global
        window.ejecutarAuditoria = ejecutarAuditoria;
        window.mostrarAdmin = mostrarAdmin;
        window.loginAdmin = loginAdmin;
    </script>
</body>
</html>
